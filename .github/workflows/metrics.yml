name: Generate GitHub Metrics

on:
  schedule:
    - cron: "0 0 * * *"  # Every day at midnight UTC
  workflow_dispatch:    # Manual trigger from Actions tab

jobs:
  metrics:
    runs-on: ubuntu-latest
    steps:
      - uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.GITHUB_TOKEN }}  # Auto-uses your repo token
          user: cmwrxh                        # Your username
          template: classic                   # Or 'repository' for repo-specific
          base: header, activity, community, repositories, metadata
          config_timezone: Africa/Nairobi     # Your timezone
          plugin_achievements: yes            # Show achievements
          plugin_languages: yes               # Top languages
          plugin_lines: yes                   # Lines of code
          plugin_stargazers: yes              # Star history
          plugin_topics: yes                  # Repo topics
          filename: metrics.svg               # Output file name (in root)
          # Add more plugins/options as needed: https://github.com/lowlighter/metrics/blob/master/action.yml

      - name: Commit metrics to repo
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Update metrics.svg"
          file_pattern: metrics.svg
